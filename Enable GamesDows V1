@echo off
SETLOCAL EnableExtensions EnableDelayedExpansion

:: Define paths and parameters
SET "STEAM_FOLDER=C:\Program Files (x86)\Steam"
SET "STEAM_PATH=%STEAM_FOLDER%\Steam.exe"
SET "STEAM_ARGS=-bigpicture -nobootstrapupdate -skipinitialbootstrap -skipverifyfiles"
SET "EXPLORER_PATH=C:\Windows\explorer.exe"
SET "KEY_NAME=HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon"
SET "VALUE_NAME=Shell"
SET "SCRIPT_NAME=DelayedExplorerStart.bat"
SET "SCRIPT_PATH=%STEAM_FOLDER%\%SCRIPT_NAME%"

echo Setting Steam Big Picture as default shell

:: Set Steam Big Picture as the default shell
REG ADD "%KEY_NAME%" /v %VALUE_NAME% /t REG_SZ /d "\"%STEAM_PATH%\" %STEAM_ARGS%" /f

:: Verify if the registry was set correctly
REG QUERY "%KEY_NAME%" /v %VALUE_NAME%
IF NOT "%ERRORLEVEL%"=="0" (
    echo Failed to set Steam as the default shell.
    pause
    exit /b 1
)

echo Steam set as default shell successfully:
REG QUERY "%KEY_NAME%" /v %VALUE_NAME%
